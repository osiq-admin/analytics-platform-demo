{
  "model_id": "insider_dealing",
  "name": "Insider Dealing",
  "description": "Detects potential insider trading by identifying accounts that traded in related products before a significant market event (price surge, price drop, volume spike). Requires a market event (MUST_PASS) and evaluates trading activity in related products during the lookback window.",
  "time_window": "market_event_window",
  "granularity": ["product_id", "account_id"],
  "calculations": [
    {
      "calc_id": "market_event_detection",
      "strictness": "MUST_PASS",
      "threshold_setting": "insider_lookback_days",
      "score_steps_setting": "market_event_score_steps",
      "value_field": "price_change_pct"
    },
    {
      "calc_id": "large_trading_activity",
      "strictness": "OPTIONAL",
      "threshold_setting": "large_activity_multiplier",
      "score_steps_setting": "large_activity_score_steps",
      "value_field": "total_value"
    }
  ],
  "context_fields": ["product_id", "account_id", "business_date", "asset_class", "instrument_type", "event_type", "event_date"],
  "score_threshold_setting": "insider_score_threshold",
  "query": "SELECT ta.product_id, ta.account_id, ta.business_date, ta.total_value, ta.same_side_pct, me.event_type, me.event_date, me.price_change_pct, me.lookback_start, me.lookforward_end, p.asset_class, p.instrument_type FROM calc_large_trading_activity ta INNER JOIN calc_market_event_window me ON ta.product_id = me.product_id INNER JOIN product p ON ta.product_id = p.product_id WHERE ta.is_large = TRUE AND CAST(ta.business_date AS DATE) >= CAST(me.lookback_start AS DATE) AND CAST(ta.business_date AS DATE) <= CAST(me.event_date AS DATE)",
  "alert_template": {
    "title": "Insider Dealing Alert",
    "sections": ["business_description", "entity_context", "market_event_analysis", "related_products", "calculation_trace", "score_breakdown", "price_chart", "order_timeline"]
  },
  "regulatory_coverage": [
    {
      "regulation": "MAR",
      "article": "Art. 14",
      "description": "Insider dealing — trading on inside information"
    },
    {
      "regulation": "MAR",
      "article": "Art. 16",
      "description": "Surveillance obligation — detect and report suspicious orders"
    },
    {
      "regulation": "MiFID II",
      "article": "Art. 16(2)",
      "description": "Organisational requirement — effective surveillance systems"
    }
  ]
}
